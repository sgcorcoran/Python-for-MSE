
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>66. Week 8: Fitting part 2 &#8212; Python for MSE</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="71. Week 7 Lesson 4 part 2: Fitting" href="Week%208%20solutions.html" />
    <link rel="prev" title="54. Week 7: Lesson and Homework" href="../Week%207/Week%207%20Lesson%20%26%20Homework.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint">Announcement goes here...</div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Python for MSE</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MSE 2114 Python for MSE I
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../lessons_2114/week%203%20student%20lesson.html">
   1. MSE 2114 Week 3: Student Lesson - Importing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lessons_2114/week%204%20student%20lesson.html">
   2. You will need the following extensions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lessons_2114/week%205%20student%20lesson.html">
   8. Anisotropy of thermal expansion coefficient
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../python_cheat_sheet_example.html">
   9. Example Python Cheat Sheet template
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MSE%202114%20Problem%20Statements%20Spring%202022.html">
   10. MSE 2114 Math Methods I
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MSE 3114 Python for MSE II
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%201/HW%201%20solutions.html">
   1. Lesson 1 Homework Problem 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%201/Lesson%201%20video%20file%20notebook%20finished.html">
   2. Creating your own functions for import
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%201/Lesson%201%20video%20file%20notebook%20starter.html">
   3. Creating your own functions for import
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%201/lesson%201-Welcome.html">
   4. Lesson 1 Welcome to MSE 3114
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%201/lesson%201.html">
   5. Lesson 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%202/Lesson%202-%20In%20Class%20notebook%202021.html">
   6. Week 2 In Class help
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%202/Lesson%202-2020.html">
   7. Week 2 Lesson
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%202/Lesson%202.html">
   8. Week 2 Lesson
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20homework%20solution%20%282%29.html">
   9. Lesson 3 homework
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20homework%20solution.html">
   10. Lesson 3 homework
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20Part%201%20final%20file%20%282%29.html">
   11. Examples of using
   <code class="docutils literal notranslate">
    <span class="pre">
     .groupby
    </span>
   </code>
   on pandas DataFrame data with
   <code class="docutils literal notranslate">
    <span class="pre">
     bar
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     pie
    </span>
   </code>
   charts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20Part%201%20final%20file.html">
   12. Examples of using
   <code class="docutils literal notranslate">
    <span class="pre">
     .groupby
    </span>
   </code>
   on pandas DataFrame data with
   <code class="docutils literal notranslate">
    <span class="pre">
     bar
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     pie
    </span>
   </code>
   charts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20Part%201%20starter%20file-Sean-2021.html">
   13. Week 3 Lesson starter file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20Part%201%20starter%20file.html">
   14. Week 3 Lesson starter file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20Part%202%20Grouping%20plots%20together-Sean-2021.html">
   15. Week 3 Part 2 Creating multiple plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Lesson%203%20Part%202%20Grouping%20plots%20together.html">
   16. Lesson 3 Part 2 Creating multiple plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Plotting%20pandas%20DataFrame%20Groupby%20Examples-Sean-2021.html">
   17. Example of setting up an advanced grid layout of subplots.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%203/Plotting%20pandas%20DataFrame%20Groupby%20Examples.html">
   24. Example of setting up an advanced grid layout of subplots.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%204/Lesson%203%20Part%202%20Digitizing%20data%20from%20the%20literature.html">
   31. Lesson 3 Part 2 Digitizing data from an image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%204/Week%204%20Selecting%20pixel%20positions%20from%20an%20image.html">
   32. Lesson 4 Selecting pixel coordinates from an image file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%205/In%20class%20help.html">
   33. Get pixel data (last weeks homework):
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%205/Week%205%20Digitizing%20data%20from%20the%20literature.html">
   38. Week 5 Digitizing data from a copy of a data plot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%206/HW%20week%206%20solutions.html">
   39. Week 6 Homework solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%206/Week%206%20Digitizing%20data%20part%202.html">
   43. Week 6 Digitizing data from an image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%206/Week%206%20editing%20select%20routine.html">
   44. Week 6 editing selectdata()
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%206/Week%206%20homework.html">
   45. Week 6 Homework
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%206/Week%206%20HW%20in%20class%20help.html">
   46. Week 6 Homework in class hints
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%207/Applications.html">
   47. Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%207/Week%207%20Lesson%20%26%20Homework%20solutions.html">
   48. Week 7: Fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%207/Week%207%20Lesson%20%26%20Homework.html">
   54. Week 7: Lesson and Homework
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   66. Week 8: Fitting part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Week%208%20solutions.html">
   71. Week 7 Lesson 4 part 2: Fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%209/week%209%20lesson%20%26%20homework.html">
   76. Week 9: Lesson and Homework
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%209/week%209%20lesson%20and%20solutions%20prior%20to%202021.html">
   81. Week 9
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%209/week%209%20lesson%20solution.html">
   86. Week 9: Homework Solution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2010/grain%20size%20measurement-%20challenge%20problem.html">
   91. Week 10: Image Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2010/grain%20size%20measurement-Copy1.html">
   92. Week 10: Image Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2010/grain%20size%20measurement-Copy2.html">
   94. Week 10: Image Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2010/grain%20size%20measurement.html">
   96. Week 10: Image Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2011/Week%2011%20Lesson%20Analyzing%20Particles%20in%20a%20Matrix.html">
   98. Week 11 Analyzing Particles in a Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2011/Week%2011%20Lesson%20In%20Class%20Lecture.html">
   100. Week 11 Analyzing Particles in a Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2011/week%2011%20solution%20to%20application%201%20SiC-Al%20MMC.html">
   101. Week 11 Solution to Application 1: Particle size in SiC - Al MMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week%2011/Week%2011%20Solution%20to%20Application%202%20carbon%20fiber%20reinforced%20Al.html">
   102. Week 11 Solution to Application 2: carbon fiber reinforced Al
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MSE%203114%20Problem%20Statements%20Fall%202021.html">
   103. MSE 3114 Math Methods II (Fall 2021)
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/sgcorcoran/Python-for-MSE/working?urlpath=tree/lessons_3114/Week 8/Week 8 lesson.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/lessons_3114/Week 8/Week 8 lesson.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   66. Week 8: Fitting part 2
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lets-generate-some-overlapping-peak-data-simulating-differential-scanning-calorimetry-dsc-data-the-presence-of-a-peak-indicates-the-formation-of-crystals-within-the-polymer-overlapping-peaks-correspond-to-two-different-crystalline-structures-forming">
     66.1. Let’s generate some overlapping peak data simulating Differential Scanning Calorimetry (DSC) data.  The presence of a peak indicates the formation of crystals within the polymer.  Overlapping peaks correspond to two different crystalline structures forming.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dsc-will-be-discussed-in-your-polymer-engineering-course-mse-4554-the-kinetics-of-crystalization-was-discussed-briefly-in-mse-2044-and-follows-the-avrami-equation">
       66.1.1. DSC will be discussed in your Polymer engineering course MSE 4554.  The kinetics of crystalization was discussed briefly in MSE 2044 and follows the avrami equation.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#so-that-is-not-looking-so-good-lets-tweak-our-params-to-see-if-we-can-help-the-fit">
   67. So that is not looking so good!  Let’s tweak our params to see if we can help the fit.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#below-i-reduced-my-help-by-only-giving-initial-values-i-think-my-initial-guess-for-the-amplitudes-was-off-enough-that-my-constraints-we-too-tight-on-the-other-variables">
     67.1. Below I reduced my “help”  by only giving initial values.  I think my initial guess for the amplitudes was off enough that my constraints we too tight on the other variables.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lets-look-at-how-to-use-our-fit-parameters-to-plot-the-gaussian-function-the-fit-parameters-are-found-in-variable-result-by-asking-for-the-best-values-i-e-result-best-values">
     67.2. Let’s look at how to use our fit parameters to plot the gaussian function.  The fit parameters are found in variable “result” by asking for the best values, i.e. result.best_values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#so-thats-the-idea-now-you-try-it">
   68. So that’s the idea… now you try it.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-you-are-going-to-fit-real-data-so-you-will-need-to-use-our-selectdata-and-cal-functions-to-get-the-data-from-the-plots-below-then-you-will-fit-this-set-of-data">
     68.1. Now you are going to fit real data so you will need to use our
     <code class="docutils literal notranslate">
      <span class="pre">
       selectdata()
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       cal()
      </span>
     </code>
     functions to get the data from the plots below.  Then you will fit this set of data.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#y-k-n-t-n-1-e-k-t-n">
   69. $
   <span class="math notranslate nohighlight">
    \(Y'= k n t^{n-1} e^{-k t^n}\)
   </span>
   $
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#y-normalized-e-frac-n-1-left-t-n-1-right-n-t-n-1">
   70. $
   <span class="math notranslate nohighlight">
    \(Y'(normalized) = e^{-\frac{(n-1) \left(t^n-1\right)}{n}} t^{n-1}\)
   </span>
   $
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#text-a-e-frac-text-n-1-left-left-frac-t-text-b-right-text-n-1-right-text-n-left-frac-t-text-b-right-text-n-1">
     70.1. $
     <span class="math notranslate nohighlight">
      \(\text{A } e^{-\frac{(\text{n}-1) \left(\left(\frac{t}{\text{B}}\right)^{\text{n}}-1\right)}{\text{n}}} \left(\frac{t}{\text{B}}\right)^{\text{n}-1}\)
     </span>
     $
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Week 8: Fitting part 2</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   66. Week 8: Fitting part 2
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lets-generate-some-overlapping-peak-data-simulating-differential-scanning-calorimetry-dsc-data-the-presence-of-a-peak-indicates-the-formation-of-crystals-within-the-polymer-overlapping-peaks-correspond-to-two-different-crystalline-structures-forming">
     66.1. Let’s generate some overlapping peak data simulating Differential Scanning Calorimetry (DSC) data.  The presence of a peak indicates the formation of crystals within the polymer.  Overlapping peaks correspond to two different crystalline structures forming.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dsc-will-be-discussed-in-your-polymer-engineering-course-mse-4554-the-kinetics-of-crystalization-was-discussed-briefly-in-mse-2044-and-follows-the-avrami-equation">
       66.1.1. DSC will be discussed in your Polymer engineering course MSE 4554.  The kinetics of crystalization was discussed briefly in MSE 2044 and follows the avrami equation.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#so-that-is-not-looking-so-good-lets-tweak-our-params-to-see-if-we-can-help-the-fit">
   67. So that is not looking so good!  Let’s tweak our params to see if we can help the fit.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#below-i-reduced-my-help-by-only-giving-initial-values-i-think-my-initial-guess-for-the-amplitudes-was-off-enough-that-my-constraints-we-too-tight-on-the-other-variables">
     67.1. Below I reduced my “help”  by only giving initial values.  I think my initial guess for the amplitudes was off enough that my constraints we too tight on the other variables.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lets-look-at-how-to-use-our-fit-parameters-to-plot-the-gaussian-function-the-fit-parameters-are-found-in-variable-result-by-asking-for-the-best-values-i-e-result-best-values">
     67.2. Let’s look at how to use our fit parameters to plot the gaussian function.  The fit parameters are found in variable “result” by asking for the best values, i.e. result.best_values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#so-thats-the-idea-now-you-try-it">
   68. So that’s the idea… now you try it.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-you-are-going-to-fit-real-data-so-you-will-need-to-use-our-selectdata-and-cal-functions-to-get-the-data-from-the-plots-below-then-you-will-fit-this-set-of-data">
     68.1. Now you are going to fit real data so you will need to use our
     <code class="docutils literal notranslate">
      <span class="pre">
       selectdata()
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       cal()
      </span>
     </code>
     functions to get the data from the plots below.  Then you will fit this set of data.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#y-k-n-t-n-1-e-k-t-n">
   69. $
   <span class="math notranslate nohighlight">
    \(Y'= k n t^{n-1} e^{-k t^n}\)
   </span>
   $
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#y-normalized-e-frac-n-1-left-t-n-1-right-n-t-n-1">
   70. $
   <span class="math notranslate nohighlight">
    \(Y'(normalized) = e^{-\frac{(n-1) \left(t^n-1\right)}{n}} t^{n-1}\)
   </span>
   $
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#text-a-e-frac-text-n-1-left-left-frac-t-text-b-right-text-n-1-right-text-n-left-frac-t-text-b-right-text-n-1">
     70.1. $
     <span class="math notranslate nohighlight">
      \(\text{A } e^{-\frac{(\text{n}-1) \left(\left(\frac{t}{\text{B}}\right)^{\text{n}}-1\right)}{\text{n}}} \left(\frac{t}{\text{B}}\right)^{\text{n}-1}\)
     </span>
     $
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="week-8-fitting-part-2">
<h1><span class="section-number">66. </span>Week 8: Fitting part 2<a class="headerlink" href="#week-8-fitting-part-2" title="Permalink to this headline">#</a></h1>
<hr style="height: 3.0px"/><p>Let’s take a look at a more advanced fitting package for this week.</p>
<p><strong>Part 2</strong>:  new package: <code class="docutils literal notranslate"><span class="pre">lmfit</span></code> <a class="reference external" href="https://lmfit.github.io/lmfit-py/">https://lmfit.github.io/lmfit-py/</a></p>
<blockquote>
<div><ol class="simple">
<li><p>We will first learn to install a new package to our Python installation</p></li>
<li><p>Application: Cystallization Kinetics of an ionic liquid (Royal Society of Chemistry Advances &gt;(RSC Adv.), 2014, vol. 4, p. 22277)</p></li>
<li><p>Fitting (deconvolution) of two overlapping peaks in calorimetry data</p></li>
</ol>
</div></blockquote>
<p>Much of this lesson is taken from:
<a class="reference external" href="https://chrisostrouchov.com/post/peak_fit_xrd_python/">https://chrisostrouchov.com/post/peak_fit_xrd_python/</a></p>
<p>The first thing you need to do is install the new package “lmfit” as explained in the short video below. If the video below isn’t working, you can go directly to the youtube link: <a class="reference external" href="https://youtu.be/R8FX2G8m6XM">https://youtu.be/R8FX2G8m6XM</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">IFrame</span>

<span class="c1"># Youtube</span>
<span class="c1">#HTML(&#39;&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/R8FX2G8m6XM?rel=0&amp;amp;controls=0&amp;amp;showinfo=0&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;&#39;)</span>
<span class="n">IFrame</span><span class="p">(</span><span class="s2">&quot;https://www.youtube.com/embed/R8FX2G8m6XM&quot;</span><span class="p">,</span><span class="mi">870</span><span class="p">,</span><span class="mi">613</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="870"
    height="613"
    src="https://www.youtube.com/embed/R8FX2G8m6XM"
    frameborder="0"
    allowfullscreen

></iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">########  The lmfit import will not work until you install lmfit as described above. </span>

<span class="c1"># import os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">#from scipy import optimize, signal</span>

<span class="kn">from</span> <span class="nn">lmfit</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Parameters</span>
</pre></div>
</div>
</div>
</div>
<section id="lets-generate-some-overlapping-peak-data-simulating-differential-scanning-calorimetry-dsc-data-the-presence-of-a-peak-indicates-the-formation-of-crystals-within-the-polymer-overlapping-peaks-correspond-to-two-different-crystalline-structures-forming">
<h2><span class="section-number">66.1. </span>Let’s generate some overlapping peak data simulating Differential Scanning Calorimetry (DSC) data.  The presence of a peak indicates the formation of crystals within the polymer.  Overlapping peaks correspond to two different crystalline structures forming.<a class="headerlink" href="#lets-generate-some-overlapping-peak-data-simulating-differential-scanning-calorimetry-dsc-data-the-presence-of-a-peak-indicates-the-formation-of-crystals-within-the-polymer-overlapping-peaks-correspond-to-two-different-crystalline-structures-forming" title="Permalink to this headline">#</a></h2>
<section id="dsc-will-be-discussed-in-your-polymer-engineering-course-mse-4554-the-kinetics-of-crystalization-was-discussed-briefly-in-mse-2044-and-follows-the-avrami-equation">
<h3><span class="section-number">66.1.1. </span>DSC will be discussed in your Polymer engineering course MSE 4554.  The kinetics of crystalization was discussed briefly in MSE 2044 and follows the avrami equation.<a class="headerlink" href="#dsc-will-be-discussed-in-your-polymer-engineering-course-mse-4554-the-kinetics-of-crystalization-was-discussed-briefly-in-mse-2044-and-follows-the-avrami-equation" title="Permalink to this headline">#</a></h3>
<blockquote>
<div><p>Aside: These are the “S” shaped curves we looked at in MSE 2044 Phase Transformations and in last weeks lesson.  The avrami curve has the form <img alt="image.png" src="lessons_3114/Week 8/attachment:image.png" /></p>
</div></blockquote>
<p>We are going to use a gaussian peak function to generate our “simulated” data.  We will look at real data for homework.  The idea here is learn how to fit overlapping peaks with “ideal” data and then we can apply this to real data.</p>
<p>Gaussian peak function:
<img alt="image.png" src="lessons_3114/Week 8/attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The Gaussian function above is: A/(σ*np.sqrt(2*np.pi)) * np.exp(-1/2*((x - μ) / σ)**2)</span>
<span class="c1"># So let&#39;s write this as a python function called, g.  </span>
<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">σ</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">σ</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">μ</span><span class="p">)</span> <span class="o">/</span> <span class="n">σ</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># A is the amplitude</span>
<span class="c1"># μ is the peak mean </span>
<span class="c1"># σ is the standard deviation</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Aside:  to get greek letters for variable names as above type for example “\sigma” and then press tab key</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate some data for two peaks.</span>
<span class="c1"># here we define the parameters [A,μ,σ] for the two peaks</span>
<span class="n">g_0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">250.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span> <span class="c1"># [A,μ,σ] peak centered at 4</span>
<span class="n">g_1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="c1"># [A,μ,σ] peak centered at -5</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">150</span> <span class="c1"># number of points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="c1">#generate our x data</span>
<span class="n">noise</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1">#generate some noise to add to our peaks</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">g_0</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">g_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span> <span class="c1">#generating some data with random noise</span>
<span class="c1"># the star operator used in the above line is discussed below</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">g_0</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">);</span> <span class="c1">#peak at 4</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">g_1</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">);</span> <span class="c1">#peak at -5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">);</span> <span class="c1">#noise</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">);</span> <span class="c1">#sum of the above</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;arbitrary amplitude&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;arbitray temperature&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Week 8 lesson_10_0.png" src="../../_images/Week 8 lesson_10_0.png" />
</div>
</div>
<blockquote>
<div><p>I used the star operator above for example *g_0 as a shortcut.  The above *g_0 places the values 250.0, 4.0, 5.0 into our function call <strong>without</strong> the square brackets.  The following are equivalent:</p>
</div></blockquote>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">g_0</span><span class="p">)</span> <span class="ow">or</span> 
<span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">g_0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g_0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">g_0</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>  
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Follow these steps to use the lmfit package </span>

<span class="c1"># Our x,y data defined: </span>

<span class="n">g_0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">250.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span> <span class="c1"># [A,μ,σ] peak centered at 4</span>
<span class="n">g_1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="c1"># [A,μ,σ] peak centered at -5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span> <span class="c1">#generate our x data</span>
<span class="n">noise</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span> <span class="c1">#generate noise - must have the same number of pts as x (150)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">g_0</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">g_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span> <span class="c1">#generate our y-data</span>

<span class="c1"># when using a function more than once it is useful to define a prefix to separate variables</span>
<span class="c1"># for example, the amplitude in model_1 will now be called m1_A</span>
<span class="c1"># likewise in model_2 it will be m2_A</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">σ</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">σ</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">μ</span><span class="p">)</span> <span class="o">/</span> <span class="n">σ</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">model_1</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;m1_&#39;</span><span class="p">)</span> <span class="c1"># g is the function we defined above</span>
<span class="n">model_2</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;m2_&#39;</span><span class="p">)</span> <span class="c1"># using the same function but changing prefix</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_1</span> <span class="o">+</span> <span class="n">model_2</span> <span class="c1"># our fitting model is the sum of the two</span>

<span class="c1"># now we help the fitting process by giving starting values and bounds on our parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="c1"># parameters given as: (NAME, VALUE, VARY?, MIN,  MAX,  EXPR,  BRUTE_STEP)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_many</span><span class="p">((</span><span class="s1">&#39;m1_A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m1_μ&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m1_σ&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m2_A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m2_μ&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m2_σ&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="c1">#now we perform the fit to our x &amp; y data with the given params</span>
<span class="n">comps</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">eval_components</span><span class="p">()</span> <span class="c1">#this separates the results into the two components model_1 and model_2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span> <span class="c1">#our x,y data blue dots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;best fit&#39;</span><span class="p">)</span> <span class="c1"># our overall fit red line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;m1_&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model_1&#39;</span><span class="p">)</span> <span class="c1"># peak 1 fit black dashed</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;m2_&#39;</span><span class="p">],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model_2&#39;</span><span class="p">)</span> <span class="c1"># peak 2 fit green dashed</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#print(result.fit_report())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">best_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Week 8 lesson_12_0.png" src="../../_images/Week 8 lesson_12_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;m2_A&#39;: 20.04242438169442, &#39;m2_μ&#39;: -4.955798567351131, &#39;m2_σ&#39;: 0.9628857360139791, &#39;m1_A&#39;: 250.20998181561924, &#39;m1_μ&#39;: 3.979688831255553, &#39;m1_σ&#39;: 4.946485411861596}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[Model]]
    (Model(g, prefix=&#39;m1_&#39;) + Model(g, prefix=&#39;m2_&#39;))
[[Fit Statistics]]
    # fitting method   = leastsq
    # function evals   = 178
    # data points      = 150
    # variables        = 6
    chi-square         = 138.010548
    reduced chi-square = 0.95840659
    Akaike info crit   = -0.49577616
    Bayesian info crit = 17.5680356
[[Variables]]
    m1_A:  250.209982 +/- 2.95279888 (1.18%) (init = 3)
    m1_μ:  3.97968883 +/- 0.05240132 (1.32%) (init = 5)
    m1_σ:  4.94648541 +/- 0.07591733 (1.53%) (init = 1)
    m2_A:  20.0424244 +/- 1.21752207 (6.07%) (init = 1)
    m2_μ: -4.95579857 +/- 0.04574606 (0.92%) (init = -3)
    m2_σ:  0.96288574 +/- 0.05261559 (5.46%) (init = 1)
[[Correlations]] (unreported correlations are &lt; 0.100)
    C(m1_A, m1_σ) = 0.849
    C(m2_A, m2_σ) = 0.715
    C(m1_σ, m2_A) = -0.665
    C(m1_A, m2_A) = -0.621
    C(m1_σ, m2_σ) = -0.451
    C(m1_A, m2_σ) = -0.429
    C(m1_μ, m2_A) = 0.257
    C(m1_μ, m2_σ) = 0.195
    C(m1_A, m2_μ) = -0.125
    C(m2_A, m2_μ) = 0.120
    C(m1_μ, m2_μ) = 0.114
    C(m1_σ, m2_μ) = -0.110
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="so-that-is-not-looking-so-good-lets-tweak-our-params-to-see-if-we-can-help-the-fit">
<h1><span class="section-number">67. </span>So that is not looking so good!  Let’s tweak our params to see if we can help the fit.<a class="headerlink" href="#so-that-is-not-looking-so-good-lets-tweak-our-params-to-see-if-we-can-help-the-fit" title="Permalink to this headline">#</a></h1>
<section id="below-i-reduced-my-help-by-only-giving-initial-values-i-think-my-initial-guess-for-the-amplitudes-was-off-enough-that-my-constraints-we-too-tight-on-the-other-variables">
<h2><span class="section-number">67.1. </span>Below I reduced my “help”  by only giving initial values.  I think my initial guess for the amplitudes was off enough that my constraints we too tight on the other variables.<a class="headerlink" href="#below-i-reduced-my-help-by-only-giving-initial-values-i-think-my-initial-guess-for-the-amplitudes-was-off-enough-that-my-constraints-we-too-tight-on-the-other-variables" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="c1">#parameters given as: (NAME, VALUE, VARY, MIN,  MAX,  EXPR,  BRUTE_STEP)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_many</span><span class="p">((</span><span class="s1">&#39;m1_A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m1_μ&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m1_σ&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m2_A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m2_μ&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;m2_σ&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="c1">#now we perform the fit to our x &amp; y data with the given params</span>
<span class="n">comps</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">eval_components</span><span class="p">()</span> <span class="c1">#this separates the results into the two components model_1 and model_2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;best fit&#39;</span><span class="p">)</span> <span class="c1"># sum of peak 1 and peak 2 fits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;m1_&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model_1&#39;</span><span class="p">)</span> <span class="c1"># peak 1 fit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;m2_&#39;</span><span class="p">],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model_2&#39;</span><span class="p">)</span> <span class="c1"># peak 2 fit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#print(result.fit_report())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">best_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Week 8 lesson_15_0.png" src="../../_images/Week 8 lesson_15_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;m2_A&#39;: 20.04242438169442, &#39;m2_μ&#39;: -4.955798567351131, &#39;m2_σ&#39;: 0.9628857360139791, &#39;m1_A&#39;: 250.20998181561924, &#39;m1_μ&#39;: 3.979688831255553, &#39;m1_σ&#39;: 4.946485411861596}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># recall g(x,A,μ,σ) and using the m1_A, m1_μ, and m1_σ printed in the previous cell</span>
<span class="n">g</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">254.2</span><span class="p">,</span> <span class="mf">3.95</span><span class="p">,</span> <span class="mf">5.108</span><span class="p">)</span> <span class="c1"># here is the y value for peak 1 (black dashed) at an x position of 10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.844899900900574
</pre></div>
</div>
</div>
</div>
<p><strong>Now we have a nice fit!</strong></p>
</section>
<section id="lets-look-at-how-to-use-our-fit-parameters-to-plot-the-gaussian-function-the-fit-parameters-are-found-in-variable-result-by-asking-for-the-best-values-i-e-result-best-values">
<h2><span class="section-number">67.2. </span>Let’s look at how to use our fit parameters to plot the gaussian function.  The fit parameters are found in variable “result” by asking for the best values, i.e. result.best_values<a class="headerlink" href="#lets-look-at-how-to-use-our-fit-parameters-to-plot-the-gaussian-function-the-fit-parameters-are-found-in-variable-result-by-asking-for-the-best-values-i-e-result-best-values" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">best_values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="c1">#notice values are returned as a dictionary</span>
<span class="c1">#to get a single value use the &quot;key&quot; for example</span>
<span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m2_μ&#39;</span><span class="p">]</span> <span class="c1"># using key m2_μ</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;m2_A&#39;: 20.04242438169442, &#39;m2_μ&#39;: -4.955798567351131, &#39;m2_σ&#39;: 0.9628857360139791, &#39;m1_A&#39;: 250.20998181561924, &#39;m1_μ&#39;: 3.979688831255553, &#39;m1_σ&#39;: 4.946485411861596}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-4.955798567351131
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># or to get a list of just values of the dictionary</span>
<span class="nb">list</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[20.04242438169442,
 -4.955798567351131,
 0.9628857360139791,
 250.20998181561924,
 3.979688831255553,
 4.946485411861596]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">150</span> <span class="c1"># number of points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="c1">#generate our x data</span>
<span class="c1"># recall our function g() has 4 params in this order g(x, A, μ, σ)</span>
<span class="n">y1</span><span class="o">=</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m1_A&#39;</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m1_μ&#39;</span><span class="p">],</span><span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m1_σ&#39;</span><span class="p">])</span> 
<span class="n">y2</span><span class="o">=</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m2_A&#39;</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m2_μ&#39;</span><span class="p">],</span><span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m2_σ&#39;</span><span class="p">])</span>
<span class="n">ysum</span><span class="o">=</span> <span class="n">y1</span><span class="o">+</span><span class="n">y2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ysum</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;arbitrary amplitude&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;arbitray temperature&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Week 8 lesson_21_0.png" src="../../_images/Week 8 lesson_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m1_A&#39;</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m1_μ&#39;</span><span class="p">],</span><span class="n">vals</span><span class="p">[</span><span class="s1">&#39;m1_σ&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.8841535429129284
</pre></div>
</div>
</div>
</div>
<hr style="height: 3px" \> 
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="so-thats-the-idea-now-you-try-it">
<h1><span class="section-number">68. </span>So that’s the idea… now you try it.<a class="headerlink" href="#so-thats-the-idea-now-you-try-it" title="Permalink to this headline">#</a></h1>
<hr style="height: 3px" \>
<section id="now-you-are-going-to-fit-real-data-so-you-will-need-to-use-our-selectdata-and-cal-functions-to-get-the-data-from-the-plots-below-then-you-will-fit-this-set-of-data">
<h2><span class="section-number">68.1. </span>Now you are going to fit real data so you will need to use our <code class="docutils literal notranslate"><span class="pre">selectdata()</span></code> and <code class="docutils literal notranslate"><span class="pre">cal()</span></code> functions to get the data from the plots below.  Then you will fit this set of data.<a class="headerlink" href="#now-you-are-going-to-fit-real-data-so-you-will-need-to-use-our-selectdata-and-cal-functions-to-get-the-data-from-the-plots-below-then-you-will-fit-this-set-of-data" title="Permalink to this headline">#</a></h2>
<hr style="height:1px"\>
<p><strong>Problem 1:</strong> reproduce the data below.  You will need all three curves.  The green (thick) curve is the measured data from DSC. Let’s call this <strong>“dsc_data”</strong>.  The peaks labeled P1 and P2 are the fitted curves found by the authors. Let’s call these <strong>“p1_auth_data”</strong> and <strong>“p2_auth_data”</strong>.</p>
<hr style="height:1px"\><p><img alt="image.png" src="lessons_3114/Week 8/attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">σ</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">σ</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">μ</span><span class="p">)</span> <span class="o">/</span> <span class="n">σ</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="c1"># g is the function we defined above</span>
<span class="c1"># now we help the fitting process by giving starting values and bounds on our parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="c1"># parameters given as: (NAME, VALUE, VARY?, MIN,  MAX,  EXPR,  BRUTE_STEP)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_many</span><span class="p">((</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;μ&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;σ&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

<span class="c1"># fix these lines below for your data set</span>
<span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;p1 cal x data&quot;</span>
<span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;p1 cal y data&quot;</span>


<span class="n">result_p1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="c1">#now we perform the fit to our x &amp; y data with the given params</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span> <span class="c1">#our x,y data blue dots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result_p1</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;best fit&#39;</span><span class="p">)</span> <span class="c1"># our overall fit red line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#print(result.fit_report())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">best_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">Input In [13],</span> in <span class="ni">&lt;cell line: 17&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;p1 cal x data&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;p1 cal y data&quot;</span>
<span class="ne">---&gt; </span><span class="mi">17</span> <span class="n">result_p1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="c1">#now we perform the fit to our x &amp; y data with the given params</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span> <span class="c1">#our x,y data blue dots</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">result_p1</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;best fit&#39;</span><span class="p">)</span> <span class="c1"># our overall fit red line</span>

<span class="nn">File ~\anaconda3\lib\site-packages\lmfit\model.py:1028,</span> in <span class="ni">Model.fit</span><span class="nt">(self, data, params, weights, method, iter_cb, scale_covar, verbose, fit_kws, nan_policy, calc_covar, max_nfev, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1026</span> <span class="c1"># Make sure `dtype` for data is always `float64` or `complex128`</span>
<span class="g g-Whitespace">   </span><span class="mi">1027</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isrealobj</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1028</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1029</span> <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1030</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex128&#39;</span><span class="p">)</span>

<span class="nn">File &lt;__array_function__ internals&gt;:5,</span> in <span class="ni">asfarray</span><span class="nt">(*args, **kwargs)</span>

<span class="nn">File ~\anaconda3\lib\site-packages\numpy\lib\type_check.py:114,</span> in <span class="ni">asfarray</span><span class="nt">(a, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">_nx</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">_nx</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="n">dtype</span> <span class="o">=</span> <span class="n">_nx</span><span class="o">.</span><span class="n">float_</span>
<span class="ne">--&gt; </span><span class="mi">114</span> <span class="k">return</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="ne">ValueError</span>: could not convert string to float: &#39;p1 cal y data&#39;
</pre></div>
</div>
</div>
</div>
<hr style="height:1px"\>
<p><strong>Problem 2:</strong> Fit the three data sets (dsc_data, p1_auth_data, and p2_auth_data) you just created using the Gauassian function, g, as done in the lesson.  The fit for <code class="docutils literal notranslate"><span class="pre">fit_dsc</span></code> will require two peaks as in the lesson.  The fits for <code class="docutils literal notranslate"><span class="pre">p1_auth_data</span></code> and <code class="docutils literal notranslate"><span class="pre">p2_auth_data</span></code> will only require you to use one peak for the fitting.  Refer to these as “<em>fit_dsc</em>”, “<em>fit_p1_auth</em>” and “<em>fit_p2_auth</em>”.   Plot each fit along with your data sets to ensure an adequate fit when comparing <code class="docutils literal notranslate"><span class="pre">dsc_data</span></code> to <code class="docutils literal notranslate"><span class="pre">fit_dsc</span></code>.</p>
<p>That is, plot <code class="docutils literal notranslate"><span class="pre">dsc_data</span></code>, <code class="docutils literal notranslate"><span class="pre">p1_auth_data</span></code>, <code class="docutils literal notranslate"><span class="pre">p2_auth_data</span></code>, <code class="docutils literal notranslate"><span class="pre">fit_dsc</span></code>, <code class="docutils literal notranslate"><span class="pre">fit_p1_auth</span></code>, and <code class="docutils literal notranslate"><span class="pre">fit_p2_auth</span></code> all on one plot.</p>
<hr style="height:1px"\><hr style="height:1px"\>
<p><strong>Problem 3:</strong></p>
<ol class="simple">
<li><p>Take your fits to P1 (fit_p1_auth) and P2 (fit_p2_auth) and add them together. You can do this by placing your fit parameters back into the g() function and summing, i.e. g(x, <em>p1 params</em>) + g(x, <em>p2 params</em>).  This is then the fit that the authors got to the overall curve.</p></li>
<li><p>Plot the author’s fit that you just found along with the overall data curve (dsc_data) and add your your fit (fit_dsc) to this plot.  How does your fit compare to the author’s fit?</p></li>
<li><p>Separate your overall fit (fit_dsc) into its two components (peaks).  Plot your two components (<code class="docutils literal notranslate"><span class="pre">comps['m1_']</span></code> and <code class="docutils literal notranslate"><span class="pre">comps['m2_']</span></code> if you used the same prefix I did in the lesson) along with the author’s P1 (fit_p1_auth) and P2 (fit_p2_auth).  How do these compare?</p></li>
<li><p>If the area under the curve P1 and P2 represent the relative amounts of each phase 1 and 2, do your results suggest an increase or decrease in the relative amount of P1/P2.  You do not need to calculate anything here.  Just eyeball it.</p></li>
</ol>
<hr style="height:1px"\><p>Now there really isn’t any reason to assume a gaussian profile for the DSC data as the authors in this paper have done.  In fact, we expect the kinetics of crystallization to follow avrami kinetics.  These are the “S” shaped curves we looked at in MSE 2044 Phase Transformations and in last weeks lesson.  The avrami curve has the form <img alt="image.png" src="lessons_3114/Week 8/attachment:image.png" /></p>
<p>The peak in the DSC data should just be the derivative of the avrami equation.</p>
<p>Derivative of Avrami</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="y-k-n-t-n-1-e-k-t-n">
<h1><span class="section-number">69. </span>$<span class="math notranslate nohighlight">\(Y'= k n t^{n-1} e^{-k t^n}\)</span>$<a class="headerlink" href="#y-k-n-t-n-1-e-k-t-n" title="Permalink to this headline">#</a></h1>
<p>The above equation is given in normalized form below, i.e. the height = 1 and peak position = 1</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="y-normalized-e-frac-n-1-left-t-n-1-right-n-t-n-1">
<h1><span class="section-number">70. </span>$<span class="math notranslate nohighlight">\(Y'(normalized) = e^{-\frac{(n-1) \left(t^n-1\right)}{n}} t^{n-1}\)</span>$<a class="headerlink" href="#y-normalized-e-frac-n-1-left-t-n-1-right-n-t-n-1" title="Permalink to this headline">#</a></h1>
<p>So to fit to an arbitrary amplitude, A, and peak position, B we could write:</p>
<section id="text-a-e-frac-text-n-1-left-left-frac-t-text-b-right-text-n-1-right-text-n-left-frac-t-text-b-right-text-n-1">
<h2><span class="section-number">70.1. </span>$<span class="math notranslate nohighlight">\(\text{A } e^{-\frac{(\text{n}-1) \left(\left(\frac{t}{\text{B}}\right)^{\text{n}}-1\right)}{\text{n}}} \left(\frac{t}{\text{B}}\right)^{\text{n}-1}\)</span>$<a class="headerlink" href="#text-a-e-frac-text-n-1-left-left-frac-t-text-b-right-text-n-1-right-text-n-left-frac-t-text-b-right-text-n-1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Avrami peak function as derived above: </span>
<span class="c1"># where A = amplitude, B = peak position, n = avrami fitting parameter</span>
<span class="k">def</span> <span class="nf">pAvram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">/</span><span class="n">B</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(((</span><span class="n">x</span><span class="o">/</span><span class="n">B</span><span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">pAvram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mf">3.23</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Week 8 lesson_31_0.png" src="../../_images/Week 8 lesson_31_0.png" />
</div>
</div>
<hr style="height:1px"\>
<p><strong>Problem 4:</strong></p>
<ol class="simple">
<li><p>Refit the dsc_data now using the pAvram function we just developed.</p></li>
<li><p>Compare this fit to the author’s fit and our gaussian fit.  Which fit is the best by eye?</p></li>
<li><p>Plot the components of this avrami fit compared to the author’s fit.  How do the peaks P1 and P2 compare?  How about the ratio of P1/P2.</p></li>
</ol>
<hr style="height:1px"\></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lessons_3114\Week 8"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../Week%207/Week%207%20Lesson%20%26%20Homework.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">54. </span>Week 7: Lesson and Homework</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Week%208%20solutions.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">71. </span>Week 7 Lesson 4 part 2: Fitting</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Sean Corcoran<br/>
  
      &copy; Copyright 2022.<br/>
    <div class="extra_footer">
      extra footer text goes here
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>